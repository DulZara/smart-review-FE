<div class="assignments-wrapper">
  <!-- Toolbar -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div class="search-box">
      <input
        type="text"
        class="form-control search-input"
        placeholder="Search"
        [(ngModel)]="q"
        name="search"
      />
    </div>

    <button class="btn btn-primary fw-semibold" (click)="openModal()">
      Add Assignment
    </button>
  </div>

  <!-- Table -->
  <div class="table-responsive shadow-sm rounded bg-white">
    <table class="table mb-0 align-middle">
      <thead class="table-active">
        <tr>
          <th>Start Date</th>
          <th>Assignment Name</th>
          <th>Topic</th>
          <th>End Date</th>
          <th>Total Submissions</th>
          <th>Is MCQ</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let r of filtered()">
          <td class="text-primary fw-medium">{{ r.startDate || 'â€”' }}</td>
          <td>{{ r.title }}</td>
          <td class="text-primary">{{ r.topic }}</td>
          <td>{{ r.endDate || 'â€”' }}</td>
          <td>{{ r.submitted }}/{{ r.graded }}</td>
          <td>
            <span
              class="badge"
              [ngClass]="{
                'bg-success': r.isMcq,
                'bg-secondary': !r.isMcq
              }"
              >{{ r.isMcq ? 'Yes' : 'No' }}</span
            >
          </td>
          <td>
            <a class="text-primary text-decoration-none fw-medium" href="#">
              View
            </a>
          </td>
        </tr>

        <!-- Empty state -->
        <tr *ngIf="filtered().length === 0">
          <td colspan="7" class="text-center text-muted py-4">
            No assignments found
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Add Assignment Modal -->
<div
  class="modal fade show d-block"
  *ngIf="showModal"
  tabindex="-1"
  style="background-color: rgba(0,0,0,0.5);"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content rounded-3">
      <div class="modal-header">
        <h5 class="modal-title">Add New Assignment</h5>
        <button type="button" class="btn-close" (click)="closeModal()"></button>
      </div>

      <div class="modal-body">
        <form #assignmentForm="ngForm" (ngSubmit)="addAssignment(assignmentForm)">
          <!-- Assignment Name -->
          <div class="mb-3">
            <label class="form-label fw-semibold">Assignment Name</label>
            <input
              type="text"
              name="assignmentName"
              class="form-control"
              placeholder="Enter assignment name"
              required
              maxlength="100"
              ngModel
            />
          </div>

          <!-- Topic Dropdown -->
          <div class="mb-3">
            <label class="form-label fw-semibold">Topic</label>
            <select
              class="form-select"
              required
              [(ngModel)]="selectedTopicId"
              name="topicId"
            >
              <option value="" disabled selected hidden>Select a topic</option>
              <option *ngFor="let topic of topics" [value]="topic.id">
                {{ topic.title }}
              </option>
            </select>
          </div>

          <!-- Time Duration -->
          <div class="mb-3">
            <label class="form-label fw-semibold">Time Duration</label>
            <select class="form-select" name="timeDuration" required ngModel>
              <option value="00:30:00">30 Minutes</option>
              <option value="01:00:00" selected>1 Hour</option>
              <option value="02:00:00">2 Hours</option>
              <option value="03:00:00">3 Hours</option>
            </select>
          </div>

          <!-- Start Date -->
          <div class="mb-3">
            <label class="form-label fw-semibold">Start Date</label>
            <input type="date" name="startTime" class="form-control" required ngModel />
          </div>

          <!-- End Date -->
          <div class="mb-3">
            <label class="form-label fw-semibold">End Date</label>
            <input type="date" name="endTime" class="form-control" required ngModel />
          </div>

          <!-- Upload PDF -->
          <div class="mb-3">
            <label class="form-label fw-semibold">Upload PDF (required)</label>
            <input
              type="file"
              class="form-control"
              (change)="onFileSelected($event)"
              accept="application/pdf"
              
            />
            <small class="text-muted">Supported: PDF, max 10MB</small>
            <div *ngIf="selectedFileName" class="mt-2 text-success small">
              ðŸ“Ž {{ selectedFileName }}
            </div>
          </div>

          <!-- Submit + Cancel -->
          <div class="d-flex justify-content-end mt-4">
            <button type="button" class="btn btn-outline-secondary me-2" (click)="closeModal()">Cancel</button>
            <button type="submit" class="btn btn-primary" [disabled]="!assignmentForm.valid">Add</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
